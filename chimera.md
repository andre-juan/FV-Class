# **Chimera**

With the software [Chimera](https://www.cgl.ucsf.edu/Outreach/Tutorials/GettingStarted.html) (we used version 1.15), it is possible to fetch the structure of a protein whose structure is stored in the Protein Data Bank (PDB).

## **Calculation of the protein structural features**

Once in Chimera, follow the route:

> File -> Open -> (Choose PDB file)

The PDB file for the relaxed 7KVE can be found [here](./data/7KVE_relaxed.pdb). Then, in the menu:

> Actions -> Surface -> Show

This will calculate the *solvent acessible and excluded surface areas*, respectively **areaSAS** and **areaSES**.

<!-- !!!!!!!!!!!!!! TO-DO:<center><img src="figures/surface_diagram.png" width=500px/></center>
 -->
 
In order to export the features, click: 

> Tools -> Structure Analysis -> Render by Attribute

In the new window, select **residues** (atoms is the default). 

In the same window, in the tab "file" it is possible to export individual files containing the following features (one by one):

- **areaSAS** 
- **areaSES**
- **phi**
- **psi**
- **kdhydro**
- **bfactor** (inside average)

The last feature to be calculated is the relative area of exposure, known as **relSESA**. In order to do so, you need to upload to chimera the file `areaSESgxg.txt` (available [here](./data/chimera/auxiliar/areaSESgxg.txt)), and define this new attribute. Afterwards, you'll use the attribute calculator in order to calculate **relSESA** as:

> residue.areaSES/residue.areaSESgxg

Details on the procedure are found [here](http://www.rbvi.ucsf.edu/chimera/docs/UsersGuide/surfnorm.html). Follow step-by-step, and the calculation of relSESA will follow naturally.

## **Creating structural features**

The *txt* files generated by Chimera are in [this folder](./data/chimera/in/):

- data / chimera / in / areaSAS.txt
- data / chimera / in / areaSES.txt
- data / chimera / in / phi.txt
- data / chimera / in / psi.txt
- data / chimera / in / kdhydro.txt
- data / chimera / in / bfactor.txt

With this files, proceed to executing the ```parse_chimera_features.py``` script, available [here](.src/parse_chimera_features), in order to concatenate the data in these files in a single table containing all structural features for each residue in the protein.

### **How to use the code**

- **Enter in `src` folder and execute**
```shell
python parse_chimera_features.py -ip="../data/ch
imera/in" -op="../data/chimera/out"
```
Obs: We are using python version 3.9.9 which is available in the Docker image provided in this repository. 

<!-- All the *txt* files produced by Chimera are already in the Docker image. -->
