# **Chimera**

With the software [Chimera](https://www.cgl.ucsf.edu/Outreach/Tutorials/GettingStarted.html) (we used version 1.15), it is possible to fetch the structure of a protein whose structure is stored in the Protein Data Bank (PDB). The protein is identidied by its code. In this work, we study the **Factor V** (code: **7KVE**), although in the final paper we used a relaxed version of the structure, whose structure you can find [here](TO-DO: LINK 7kve_clean).

## **Protein structure properties**

Once in Chimera, follow the route:



Then, in the menu:

> Actions -> Surface -> show, 

This will calculate the *solvent acessible and excluded surface areas*, respectively **areaSAS** and **areaSES**.

!!!!!!!!!!!!!! TO-DO:<center><img src="figures/surface_diagram.png" width=500px/></center>

In order to export the features click: 

> Tools -> Structure Analysis -> Render by Attribute. 

In the new window, select **residues** (atoms is the default). 

In the same window, in the tab "file" it is possible to export the following features (one by one):

- **areaSAS** 
- **areaSES**
- **phi**
- **psi**
- **kdhydro**
- **bfactor** (inside average)

The last feature calculated was a relative area of exposure using **areaSAS** and **areaSES**, known as **relSESA**.

In order to do so, you need to upload to chimera the file **areaSESgxg.txt** (available [here]()), and define this new attribute. Afterward, you'll use the attribute calculator in order to calculate **relSESA** as:

> residue.areaSES/residue.areaSESgxg

Details on the procedure are found [here](http://www.rbvi.ucsf.edu/chimera/docs/UsersGuide/surfnorm.html). Follow step-by-step, and the calculation of relSESA will follow naturally.

## **Running the code**

All txt files generated by the chimera software should be in a folder with the following structure:

- data / \<pdb_code\>/ \<*files.txt*\>

Protein 7KVE (FV):

- data / chimera / in / areaSAS.txt
- data / chimera / in /areaSES.txt
- data / chimera / in /phi.txt
- data / chimera / in /psi.txt
- data / chimera / in /kdhydro.txt
- data / chimera / in /bfactor.txt

## Example generate concatened file. For that we'll uyse ,, available [here](to-do).

**Creates folder results and save csv file:**
```shell
python parse_chimera_features.py -ip="data/7kxy"
```

**Save csv file in current folder:**
```shell
python parse_chimera_features.py -ip="data/7kxy" -op="./"
```

**Specific folder to save csv file (it must be full path):**
```shell
python parse_chimera_features.py -ip="data/7kxy" -op="/home/rocabrera/Downloads"
```